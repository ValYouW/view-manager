<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>View Saver</title>

    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="filters/filter.css">
    <link rel="stylesheet" href="filters/filter-list.css">
    <link rel="stylesheet" href="filters/filter-option-range.css">

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>

    <script type="text/javascript">
        var myApp = angular.module('viewMgrApp', []);
        myApp.controller('viewMgrAppCtrl', function ($scope, $timeout) {
            $scope.viewMgrApi = {};
            $scope.viewMgrApi.onSave = function(data) {
                var resDiv = document.getElementById('result');
	            resDiv.innerHTML = JSON.stringify(data, null, 2);
	            //resDiv.innerHTML = JSON.stringify(data, null, 2).replace(/\n/g, '<br />');
            };

            $scope.viewsMgrModel = getViewsMgrModel();
            $scope.filtersModel = getFiltersModel();

            $scope.filtersChanged = function(data) {
                var resDiv = document.getElementById('result');
                resDiv.innerHTML = JSON.stringify(data, null, 2);
            };

            $timeout(function() {
                $scope.viewMgrApi.loadData($scope.viewsMgrModel);
            }, 200);
        });

        function getViewsMgrModel() {
	        return {
		        availableFilters: [
			        {
				        id: 'country',
				        text: 'Country',
				        options: [
					        {id: 'IL', text: 'Israel'},
					        {id: 'GB', text: 'Great Britain'},
					        {id: 'US', text: 'United States'}
				        ],
						multi: true
			        },
			        {
				        id: 'leadStatus',
				        text: 'Lead Status',
				        options: [
					        {id: '0', text: 'Trader'},
					        {id: '1', text: 'Potential'},
					        {id: '2', text: 'Non Eligible'}
				        ],
                        multi: true
			        },
			        {
				        id: 'leadReason',
				        text: 'Lead Reason',
				        options: [
					        {id: '0', text: 'Meeting'},
					        {id: '1', text: 'No Answer'},
					        {id: '2', text: 'Under-Aged'}
				        ]
			        }
		        ],
		        filters: [
			        {id: 'leadStatus', value: ['2']},
			        {id: 'country', value: ['IL', 'GB']}
		        ],
		        availableColumns: [
			        {id: 'leadStatus', text: 'Lead Status'},
			        {id: 'leadReason', text: 'Lead Reason'},
			        {id: 'country', text: 'Country'},
			        {id: 'lastLoginDate', text: 'Last Login Date'},
			        {id: 'assignedTo', text: 'Assigned To'},
					{id: 'taskDate', text: 'Task Date'},
					{id: 'brand', text: 'Brand Name'},
					{id: 'expiration', text: 'Exp Date'},
					{id: 'kycStatus', text: 'KYC Status'},
					{id: 'kycReason', text: 'KYC Reason'}

		        ],
		        columns: ['country', 'assignedTo']
	        };
        }

        function getFiltersModel() {
            return [
                {
                    id: 'country',
                    text: 'Country',
                    multi: true,
                    options: [
                        { id: 'IL', text: 'Israel', count: 10 },
                        { id: 'GB', text: 'Great Britain', count: 5 },
                        { id: 'US', text: 'United States', count: 3 }
                    ]
                },
                {
                    id: 'leadStatus',
                    text: 'Lead Status',
                    multi: true,
                    options: [
                        { id: '0', text: 'Trader', count: 150 },
                        { id: '1', text: 'Potential', count: 3578 },
                        { id: '2', text: 'Non Eligible', count: 0 }
                    ]
                },
                {
                    id: 'BALANCE',
                    text: 'Balance',
                    multi: false,
                    dataType: 'Number',
                    options: [
                        { id: '0-1000' },
                        { id: '1000-5000'},
                        { id: '5000-20000' },
                        { id: 'Custom', type: 'Range', value: {from: null, to: null} }
                    ]
                },
                {
                    id: 'USER_CREATE_DATE',
                    text: 'User Creation',
                    multi: false,
                    dataType: 'Date',
                    options: [
                        { id: 'yesterday', text: 'Yesterday' },
                        { id: 'lat7Days', text: 'Last 7 Days'},
                        { id: 'lastMonth', text: 'Last Month' },
                        { id: 'Custom', type: 'Range', value: {from: '', to: ''} }
                    ]
                }
            ];
        }

    </script>

    <script src="view-mgr-drv.js"></script>
	<script src="pxbo-combo-drv.js"></script>
    <script src="filters/filter.component.js"></script>
    <script src="filters/filter-list.component.js"></script>
    <script src="filters/filter-option-range.component.js"></script>
</head>
<body>

<div ng-app="viewMgrApp" ng-controller="viewMgrAppCtrl" style="display: flex; flex-direction: row; justify-content: space-around">
    <div style="display: inline-block; width: 400px;">
        <pxbo-view-mgr-drv api="viewMgrApi"></pxbo-view-mgr-drv>
    </div>
    <div style="display: inline-block; vertical-align: top; width: 250px; height: 600px">
        <pxbo-filter-list filters="filtersModel" on-change="filtersChanged(filters)"></pxbo-filter-list>
    </div>
    <div>
        <textarea disabled id="result" style="width: 300px; height: 500px"></textarea>
    </div>
</div>
</body>
</html>